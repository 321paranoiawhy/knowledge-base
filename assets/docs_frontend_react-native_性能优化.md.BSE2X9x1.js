import{a3 as k,k as d,l as s,J as a,L as n,Z as i,ax as l,ag as t,j as r}from"./chunks/framework.CK7x57RQ.js";const E=JSON.parse('{"title":"React Native 性能优化","description":"","frontmatter":{"breadcrumb":true,"pageInfo":true,"heatmap":true,"copyright":true},"headers":[],"relativePath":"docs/frontend/react-native/性能优化.md","filePath":"docs/frontend/react-native/性能优化.md","lastUpdated":1719568930000}'),c={name:"docs/frontend/react-native/性能优化.md"},o=l('<h1 id="react-native-性能优化" tabindex="-1">React Native 性能优化 <a class="header-anchor" href="#react-native-性能优化" aria-label="Permalink to &quot;React Native 性能优化&quot;">​</a></h1><ul><li>开发模式 (<code>dev</code>) 下性能较低, 建议在 <code>release</code> 模式下测试性能</li></ul><h2 id="移除-console-打印语句" tabindex="-1">移除 <code>console</code> 打印语句 <a class="header-anchor" href="#移除-console-打印语句" aria-label="Permalink to &quot;移除 `console` 打印语句&quot;">​</a></h2>',3),g=l(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --save-dev</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> babel-plugin-transform-remove-console</span></span></code></pre></div><p><code>.babelrc</code> 文件配置:</p><div class="language-.babelrc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">.babelrc</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;env&quot;: {</span></span>
<span class="line"><span>    &quot;production&quot;: {</span></span>
<span class="line"><span>      &quot;plugins&quot;: [&quot;transform-remove-console&quot;]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>排除 <code>console.error</code> 和 <code>console.warn</code>:</p><div class="language-.babelrc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">.babelrc</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;env&quot;: {</span></span>
<span class="line"><span>    &quot;production&quot;: {</span></span>
<span class="line"><span>      &quot;plugins&quot;: [[&quot;transform-remove-console&quot;, {&quot;exclude&quot;: [&quot;error&quot;, &quot;warn&quot;]}]]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="启用-hermes-引擎" tabindex="-1">启用 <code>Hermes</code> 引擎 <a class="header-anchor" href="#启用-hermes-引擎" aria-label="Permalink to &quot;启用 \`Hermes\` 引擎&quot;">​</a></h2><h3 id="android" tabindex="-1"><code>android</code> <a class="header-anchor" href="#android" aria-label="Permalink to &quot;\`android\`&quot;">​</a></h3><p>根目录下 <code>gradle.properties</code> 配置 <code>hermesEnabled</code>:</p><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Use this property to enable or disable the Hermes JS engine.</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># If set to false, you will be using JSC instead.</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">hermesEnabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">true</span></span></code></pre></div><p>检查是否启用 <code>Hermes</code> 引擎:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[INFO] Using Hermes:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !!</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">global</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">HermesInternal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre></div><h2 id="启用新架构" tabindex="-1">启用新架构 <a class="header-anchor" href="#启用新架构" aria-label="Permalink to &quot;启用新架构&quot;">​</a></h2>`,12),y=l(`<p><code>React Native</code> 新架构即无桥化 <code>Bridgeless</code></p><h3 id="android-1" tabindex="-1"><code>android</code> <a class="header-anchor" href="#android-1" aria-label="Permalink to &quot;\`android\`&quot;">​</a></h3><p>根目录下 <code>gradle.properties</code> 配置 <code>newArchEnabled</code>:</p><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Use this property to enable support to the new architecture.</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># This will allow you to use TurboModules and the Fabric render in</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># your application. You should enable this flag either if you want</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># to write custom TurboModules/Fabric components OR use libraries that</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># are providing them.</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">newArchEnabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">true</span></span></code></pre></div><p>或配置环境变量 <code>ORG_GRADLE_PROJECT_newArchEnabled=true</code></p><p>启用新架构后可在运行项目时看到如下打印内容 <code>&quot;fabric&quot;:true</code>:</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>(NOBRIDGE) LOG Bridgeless mode is enabled (NOBRIDGE) LOG Running &quot;rnc&quot; with {&quot;rootTag&quot;:11,&quot;initialProps&quot;:</p></div><h2 id="懒加载" tabindex="-1">懒加载 <a class="header-anchor" href="#懒加载" aria-label="Permalink to &quot;懒加载&quot;">​</a></h2><p>可懒加载的内容:</p><ul><li>组件 <code>components</code></li><li>路由 <code>route</code></li><li>图片 <code>Image</code></li><li>字体</li></ul><h3 id="组件" tabindex="-1">组件 <a class="header-anchor" href="#组件" aria-label="Permalink to &quot;组件&quot;">​</a></h3><p><code>Lazy</code> 组件或异步组件</p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> example</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">shouldRenderExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> setShouldRenderExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> useState</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 延迟加载</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">shouldRenderExample</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  example</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> require</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./example</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">default</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre></div><h2 id="cdn" tabindex="-1"><code>CDN</code> <a class="header-anchor" href="#cdn" aria-label="Permalink to &quot;\`CDN\`&quot;">​</a></h2><p>使用 <code>CDN (Content Dilivery Network)</code> 内容分发网络加速</p><h2 id="打包产物体积优化" tabindex="-1">打包产物体积优化 <a class="header-anchor" href="#打包产物体积优化" aria-label="Permalink to &quot;打包产物体积优化&quot;">​</a></h2>`,16),A=s("li",null,[i("区分不同 "),s("code",null,"CPU Architecture"),i(" ("),s("code",null,"CPU 架构"),i(", 即 "),s("code",null,"abi"),i(")")],-1),b=l(`<h3 id="abi" tabindex="-1"><code>ABI</code> <a class="header-anchor" href="#abi" aria-label="Permalink to &quot;\`ABI\`&quot;">​</a></h3><p>本地构建 <code>Android</code> 应用时, 默认会构建以下四个 <code>ABI</code>:</p><ul><li><code>arm64-v8a</code> 第 <code>8</code> 代 <code>64</code> 位 <code>ARM</code> 处理器</li><li><code>armeabi-v7a</code> 第 <code>7</code> 代及以上 <code>32</code> 位 <code>ARM</code> 处理器</li><li><code>armeabi</code> 第 <code>5</code> 代和第 <code>6</code> 代 <code>32</code> 位 <code>ARM</code> 处理器</li><li><code>x86_64</code> <code>64</code> 位 <code>Intel</code> 处理器</li><li><code>x86</code> <code>32</code> 位 <code>Intel</code> 处理器</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>可在 <code>android/gradle.properties</code> 文件种查看到如下信息:</p><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Use this property to specify which architecture you want to build.</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># You can also override it from the CLI using</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ./gradlew &lt;task&gt; -PreactNativeArchitectures=x86_64</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">reactNativeArchitectures</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">armeabi-v7a,arm64-v8a,x86,x86_64</span></span></code></pre></div></div><p>自动确定模拟器或真机 <code>ABI</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 完整命令</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># npm react-native run-android --active-arch-only</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> android</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --active-arch-only</span></span></code></pre></div>`,6),u=s("code",null,"ABI",-1),v=l(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> react-native-device-info</span></span></code></pre></div><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// supportedAbis 支持除 web 以外的 android/iOS/Windows/visionOS 平台</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">supportedAbis</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> from</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">react-native-device-info</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">supportedAbis</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">abis</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // example abis: [&quot;armeabi-v7a&quot;, &quot;armeabi&quot;]</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Supported Abis:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> abis</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  })</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span></code></pre></div><p>也可使用 <code>adb</code> 命令:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看受支持的单个 abi, 推荐将其作为安卓打包的目标架构</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 示例输出: armeabi-v7a</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">adb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shell</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> getprop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ro.product.cpu.abi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看受支持的 abi 列表</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 示例输出: armeabi-v7a,armeabi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">adb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shell</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> getprop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ro.product.cpu.abilist</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># grep 表达式过滤出含 abi 的信息</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">adb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shell</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> getprop</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> abi</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">adb shell getprop | grep abi</p></div><p>或使用 <code>DevCheck</code> 软件</p><h2 id="优化编译速度" tabindex="-1">优化编译速度 <a class="header-anchor" href="#优化编译速度" aria-label="Permalink to &quot;优化编译速度&quot;">​</a></h2><h3 id="ccache" tabindex="-1">Ccache <a class="header-anchor" href="#ccache" aria-label="Permalink to &quot;Ccache&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">brew</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span></span></code></pre></div><p>添加符号链接并指向 <code>ccache</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/gcc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/g++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/cc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/c++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/clang</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/clang++</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/gcc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/g++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/cc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/c++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/clang</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ln</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ccache</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/clang++</span></span></code></pre></div><p>::: warn 上述 <code>ccache</code> 配置将影响计算机上运行的所有编译过程, 如无法安装/编译其他软件, 可删除所创建的符号链接:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/gcc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/g++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/cc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/c++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/clang</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/bin/clang++</span></span></code></pre></div><p>或:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/gcc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/g++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/cc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/c++</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/clang</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">unlink</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/bin/clang++</span></span></code></pre></div><p>上述 <code>unlink</code> 操作可能会提示 <code>Operation not permitted</code></p><p>:::</p><p>查看 <code>gcc</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 输出 /usr/local/bin/gcc 或 /usr/bin/gcc</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gcc</span></span></code></pre></div><p>查看缓存命中情况:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ccache</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span></span></code></pre></div><p>清除缓存:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ccache</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --clear</span></span></code></pre></div>`,24);function f(D,C,B,m,_,q){const e=t("VPNolebaseInlineLinkPreview"),h=t("NolebaseGitContributors"),p=t("NolebaseGitChangelog");return r(),d("div",null,[o,s("ul",null,[s("li",null,[a(e,{href:"https://www.npmjs.com/package/babel-plugin-transform-remove-console",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("babel-plugin-transform-remove-console")]),_:1})]),s("li",null,[a(e,{href:"https://github.com/babel/minify/blob/master/packages/babel-plugin-transform-remove-console/src/index.js",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("babel-plugin-transform-remove-console 源码")]),_:1})])]),g,s("ul",null,[s("li",null,[a(e,{href:"https://reactnative.dev/blog/2024/04/22/release-0.74",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("React Native 0.74 - Yoga 3.0, Bridgeless New Architecture, and more")]),_:1})]),s("li",null,[a(e,{href:"https://github.com/reactwg/react-native-new-architecture/blob/main/docs/enable-apps.md",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("Enable the New Architecture for Apps")]),_:1})])]),y,s("ul",null,[s("li",null,[a(e,{href:"https://developer.android.com/topic/performance/reduce-apk-size#size-analyzer",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("Android Size Analyzer")]),_:1})]),A,s("li",null,[a(e,{href:"https://github.com/IjzerenHein/react-native-bundle-visualizer",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("react-native-bundle-visualizer")]),_:1})])]),b,s("p",null,[i("或自行确定模拟器或真机 "),u,i(", 如使用 "),a(e,{href:"https://www.npmjs.com/package/react-native-device-info",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("react-native-device-info")]),_:1})]),v,a(h),a(p)])}const w=k(c,[["render",f]]);export{E as __pageData,w as default};
